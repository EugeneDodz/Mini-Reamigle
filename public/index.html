<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mini Omegle</title>
</head>
<body>
  <h2>ðŸŽ™ Mini Omegle - Voice Chat</h2>
  <button id="startBtn">Start Voice Chat</button>

  <script>
    const startBtn = document.getElementById("startBtn");

    // Create Peer Connections (Simulating 2 devices: mobile & PC in same code for demo)
    const pc1 = new RTCPeerConnection(); // Mobile
    const pc2 = new RTCPeerConnection(); // PC

    // PC: Play remote audio stream
    pc2.ontrack = (event) => {
      const audio = document.createElement("audio");
      audio.srcObject = event.streams[0];
      audio.autoplay = true;
      document.body.appendChild(audio);
    };

    startBtn.addEventListener("click", async () => {
      try {
        // MOBILE: Get mic audio
        const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
        stream.getTracks().forEach(track => pc1.addTrack(track, stream));

        // Exchange ICE candidates (simulate signaling server)
        pc1.onicecandidate = e => e.candidate && pc2.addIceCandidate(e.candidate);
        pc2.onicecandidate = e => e.candidate && pc1.addIceCandidate(e.candidate);

        // Create Offer from MOBILE (pc1)
        const offer = await pc1.createOffer();
        await pc1.setLocalDescription(offer);
        await pc2.setRemoteDescription(offer);

        // Create Answer from PC (pc2)
        const answer = await pc2.createAnswer();
        await pc2.setLocalDescription(answer);
        await pc1.setRemoteDescription(answer);

        alert("Voice Chat Started! Speak into your mobile mic.");
      } catch (err) {
        console.error("Error starting chat:", err);
      }
    });
  </script>
</body>
</html>
